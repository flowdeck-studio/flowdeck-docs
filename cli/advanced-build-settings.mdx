---
title: "Advanced Build Settings"
description: "Configuration files, xcodebuild passthrough, and advanced build options"
---

FlowDeck CLI supports advanced configuration through JSON config files and xcodebuild passthrough options, giving you full control over your build process.

## Configuration File

Instead of passing parameters on the command line, you can define build settings in a JSON configuration file. This is especially useful for:

- Reproducible builds across team members
- CI/CD pipelines
- Complex build configurations
- Storing xcodebuild arguments and environment variables

### Using a Config File

```bash
flowdeck build --config path/to/config.json
flowdeck run --config path/to/config.json
flowdeck test --config path/to/config.json
```

<Tip>
  You can generate a config file from FlowDeck interactive mode using the `W` (Write Config) option.
</Tip>

### Config File Structure

```json
{
  "workspace": "MyApp.xcworkspace",
  "scheme": "MyApp",
  "configuration": "Debug",
  "platform": "iOS",
  "version": "18.0",
  "deviceUdid": "00008030-001234567890ABCD",
  "simulatorUdid": "A1B2C3D4-E5F6-7890-ABCD-EF1234567890",
  "derivedDataPath": "~/Library/Developer/FlowDeck/DerivedData",
  "xcodebuild": {
    "args": ["-enableCodeCoverage", "YES"],
    "env": {
      "CI": "true"
    }
  }
}
```

### Complete Field Reference

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `workspace` | string | **Yes** | Path to `.xcworkspace` or `.xcodeproj` (relative to project root) |
| `scheme` | string | **Yes** | Scheme name to build |
| `configuration` | string | No | Build configuration. Default: `Debug`. Options: `Debug`, `Release`, or custom |
| `platform` | string | No | Target platform. Options: `iOS`, `macOS`, `watchOS`, `tvOS`, `visionOS` |
| `version` | string | No | OS version (e.g., `18.0`, `17.5`). Uses latest available if not specified |
| `deviceUdid` | string | No | Physical device UDID for device builds |
| `simulatorUdid` | string | No | Simulator UDID for simulator builds |
| `derivedDataPath` | string | No | Custom derived data directory path |
| `xcodebuild` | object | No | Passthrough settings for xcodebuild |

### Target Resolution Priority

When determining the build target, FlowDeck uses this priority order:

1. **`deviceUdid`** - Physical device (if specified and connected)
2. **`simulatorUdid`** - Exact simulator by UDID
3. **`platform` + `version`** - Auto-resolve best matching simulator
4. **`platform: "macOS"`** - Native Mac build (no simulator needed)

### Configuration Examples

<AccordionGroup>
  <Accordion title="Minimal iOS Configuration">
    ```json
    {
      "workspace": "MyApp.xcworkspace",
      "scheme": "MyApp"
    }
    ```
    Uses default Debug configuration and latest available iOS simulator.
  </Accordion>

  <Accordion title="macOS Native Build">
    ```json
    {
      "workspace": "MyApp.xcworkspace",
      "scheme": "MyApp-macOS",
      "platform": "macOS",
      "configuration": "Release"
    }
    ```
    Builds for macOS without simulator.
  </Accordion>

  <Accordion title="Physical Device Build">
    ```json
    {
      "workspace": "MyApp.xcworkspace",
      "scheme": "MyApp",
      "deviceUdid": "00008030-001234567890ABCD"
    }
    ```
    Get device UDID from `flowdeck device list --json`.
  </Accordion>

  <Accordion title="Specific Simulator Version">
    ```json
    {
      "workspace": "MyApp.xcworkspace",
      "scheme": "MyApp",
      "platform": "iOS",
      "version": "17.5"
    }
    ```
    Targets iOS 17.5 simulator specifically.
  </Accordion>

  <Accordion title="CI Release Build">
    ```json
    {
      "workspace": "MyApp.xcworkspace",
      "scheme": "MyApp",
      "configuration": "Release",
      "platform": "iOS",
      "derivedDataPath": "/tmp/derived-data",
      "xcodebuild": {
        "args": [
          "-enableCodeCoverage", "YES",
          "CODE_SIGN_IDENTITY=-",
          "CODE_SIGNING_REQUIRED=NO"
        ],
        "env": {
          "CI": "true"
        }
      }
    }
    ```
  </Accordion>
</AccordionGroup>

## xcodebuild Passthrough

The `xcodebuild` section allows you to pass arguments and environment variables directly to xcodebuild. This gives you access to any xcodebuild feature not directly exposed by FlowDeck.

### Arguments (`args`)

Arguments are appended to the xcodebuild command line:

```json
{
  "workspace": "MyApp.xcworkspace",
  "scheme": "MyApp",
  "xcodebuild": {
    "args": [
      "-enableCodeCoverage", "YES",
      "-resultBundlePath", "./build/results.xcresult",
      "ONLY_ACTIVE_ARCH=NO",
      "OTHER_SWIFT_FLAGS=-DDEBUG -Xfrontend -warn-long-expression-type-checking=100"
    ]
  }
}
```

### Common xcodebuild Arguments

| Argument | Description |
|----------|-------------|
| `-enableCodeCoverage YES` | Enable code coverage collection |
| `-resultBundlePath <path>` | Save test results to xcresult bundle |
| `-allowProvisioningUpdates` | Allow automatic provisioning updates |
| `-allowProvisioningDeviceRegistration` | Allow automatic device registration |
| `ONLY_ACTIVE_ARCH=YES` | Build only for active architecture (faster debug builds) |
| `ONLY_ACTIVE_ARCH=NO` | Build for all architectures (required for distribution) |
| `CODE_SIGN_IDENTITY=-` | Disable code signing |
| `CODE_SIGNING_REQUIRED=NO` | Skip code signing requirement |
| `GCC_TREAT_WARNINGS_AS_ERRORS=YES` | Fail build on warnings |
| `SWIFT_TREAT_WARNINGS_AS_ERRORS=YES` | Fail build on Swift warnings |
| `OTHER_SWIFT_FLAGS=<flags>` | Additional Swift compiler flags |
| `OTHER_LDFLAGS=<flags>` | Additional linker flags |

### Environment Variables (`env`)

Environment variables are set for the xcodebuild process:

```json
{
  "workspace": "MyApp.xcworkspace",
  "scheme": "MyApp",
  "xcodebuild": {
    "env": {
      "CI": "true",
      "DEVELOPER_DIR": "/Applications/Xcode-15.4.app/Contents/Developer",
      "CUSTOM_BUILD_VAR": "value"
    }
  }
}
```

### Common Environment Variables

| Variable | Description |
|----------|-------------|
| `CI` | Indicates CI environment (affects some Xcode behaviors) |
| `DEVELOPER_DIR` | Override Xcode installation path |
| `XCODE_XCCONFIG_FILE` | Path to custom xcconfig file |

## Build Settings File

For project-wide xcodebuild settings that apply to all builds, create `.flowdeck/build-settings.json`:

```json
{
  "args": [
    "ONLY_ACTIVE_ARCH=YES",
    "GCC_TREAT_WARNINGS_AS_ERRORS=YES"
  ],
  "env": {
    "CUSTOM_VAR": "value"
  }
}
```

These settings are automatically loaded and merged with any config file settings.

<Info>
  Config file settings take priority over build-settings.json when there are conflicts.
</Info>

## Advanced Use Cases

### Code Coverage for Tests

```json
{
  "workspace": "MyApp.xcworkspace",
  "scheme": "MyApp",
  "xcodebuild": {
    "args": [
      "-enableCodeCoverage", "YES",
      "-resultBundlePath", "./coverage/results.xcresult"
    ]
  }
}
```

Extract coverage after tests:

```bash
flowdeck test --config coverage-config.json
xcrun xccov view --report ./coverage/results.xcresult
```

### Parallel Testing

```json
{
  "workspace": "MyApp.xcworkspace",
  "scheme": "MyApp",
  "xcodebuild": {
    "args": [
      "-parallel-testing-enabled", "YES",
      "-parallel-testing-worker-count", "4"
    ]
  }
}
```

### Custom Swift Flags

```json
{
  "workspace": "MyApp.xcworkspace",
  "scheme": "MyApp",
  "xcodebuild": {
    "args": [
      "OTHER_SWIFT_FLAGS=-DDEBUG -Xfrontend -warn-long-expression-type-checking=100"
    ]
  }
}
```

### Archive for Distribution

```json
{
  "workspace": "MyApp.xcworkspace",
  "scheme": "MyApp",
  "configuration": "Release",
  "xcodebuild": {
    "args": [
      "ONLY_ACTIVE_ARCH=NO",
      "-archivePath", "./build/MyApp.xcarchive"
    ]
  }
}
```

### Using Different Xcode Version

```json
{
  "workspace": "MyApp.xcworkspace",
  "scheme": "MyApp",
  "xcodebuild": {
    "env": {
      "DEVELOPER_DIR": "/Applications/Xcode-15.4.app/Contents/Developer"
    }
  }
}
```

### Sanitizers for Debugging

```json
{
  "workspace": "MyApp.xcworkspace",
  "scheme": "MyApp",
  "xcodebuild": {
    "args": [
      "OTHER_SWIFT_FLAGS=-sanitize=address",
      "OTHER_CFLAGS=-fsanitize=address",
      "OTHER_LDFLAGS=-fsanitize=address"
    ]
  }
}
```

## Custom Derived Data

Specify a custom derived data path to:

- Avoid conflicts with Xcode
- Enable parallel builds with separate derived data
- Use faster storage (e.g., RAM disk)

### In Config File

```json
{
  "workspace": "MyApp.xcworkspace",
  "scheme": "MyApp",
  "derivedDataPath": "/tmp/flowdeck-derived-data"
}
```

### On Command Line

```bash
flowdeck build --workspace MyApp.xcworkspace --scheme MyApp \
  --simulator "iPhone 16" \
  --derived-data-path ~/FlowDeck/DerivedData
```

## Troubleshooting

### Viewing Actual xcodebuild Command

Use `--verbose` to see the full xcodebuild command being executed:

```bash
flowdeck build --config my-config.json --verbose
```

### Config File Not Found

Ensure the path is correct and the file exists:

```bash
# Absolute path
flowdeck build --config /path/to/config.json

# Relative to current directory
flowdeck build --config ./configs/build.json
```

### xcodebuild Arguments Not Applied

Check that arguments are properly formatted as an array:

```json
{
  "xcodebuild": {
    "args": ["-enableCodeCoverage", "YES"]
  }
}
```

Not:

```json
{
  "xcodebuild": {
    "args": "-enableCodeCoverage YES"
  }
}
```

### Environment Variables Not Set

Verify the env object uses string values:

```json
{
  "xcodebuild": {
    "env": {
      "CI": "true",
      "COUNT": "5"
    }
  }
}
```
